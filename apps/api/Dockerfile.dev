FROM node:20-alpine
WORKDIR /app

# Copy all package files from root and all workspaces
COPY package*.json ./
COPY apps/api/package.json ./apps/api/
COPY apps/mobile-web/package.json ./apps/mobile-web/
COPY packages/*/package.json ./packages/*/

# Install all workspace dependencies
RUN npm install --legacy-peer-deps

EXPOSE 3000

CMD ["npm", "run", "dev", "-w", "api"]